<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Expectation` enum in crate `rotor_stream`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Expectation">

    <title>rotor_stream::Expectation - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>rotor_stream</a></p><script>window.sidebarCurrent = {name: 'Expectation', ty: 'enum', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content enum">
<h1 class='fqn'><span class='in-band'>Enum <a href='index.html'>rotor_stream</a>::<wbr><a class='enum' href=''>Expectation</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-116' class='srclink' href='../src/rotor_stream/protocol.rs.html#60-104' title='goto source code'>[src]</a></span></h1>
<pre class='rust enum'>pub enum Expectation {
    Bytes(<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>),
    Delimiter(<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;'static [</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>),
    Flush(<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>),
    Sleep,
}</pre><div class='docblock'><p>This is an enumeration used to declare what next protocol is expecting</p>

<p>The value is used in <code>Intent::expect()</code>.</p>

<p>Most users should use <code>IntentBuilder</code>&#39;s (a type which is returned from
<code>Intent::of(..)</code>) methods. But for some kinds of control flow being
able to specify expectation as a separate enum is very useful.</p>
</div><h2 class='variants'>Variants</h2>
<table class='variants_table'><tr><td id='variant.Bytes'><code>Bytes</code></td><td><div class='docblock'><p>Read number of bytes</p>

<p>The buffer that is passed to bytes_read might contain more bytes, but
<code>num</code> parameter of the <code>bytes_read()</code> method will contain a number of
bytes passed into <code>Bytes</code> constructor.</p>

<p>Note that bytes passed here is neither limit on bytes actually read
from the network (we resize buffer as convenient for memory allocator
and read as much as possible), nor is the preallocated buffer size
(we don&#39;t preallocate the buffer to be less vulnerable to DoS attacks).</p>

<p>Note that real number of bytes that <code>netbuf::Buf</code> might contain is less
than 4Gb. So this value can&#39;t be as big as <code>usize::MAX</code></p>
</div></td><td></td></tr><tr><td id='variant.Delimiter'><code>Delimiter</code></td><td><div class='docblock'><p>Read until delimiter</p>

<p>Parameters: <code>offset</code>, <code>delimiter</code>, <code>max_bytes</code></p>

<p>Only static strings are supported for delimiter now.</p>

<p><code>bytes_read</code> action gets passed <code>num</code> bytes before the delimeter, or
in other words, the position of the delimiter in the buffer.
The delimiter is guaranteed to be in the buffer too. The <code>max_bytes</code>
do include the offset itself.</p>
</div></td><td></td></tr><tr><td id='variant.Flush'><code>Flush</code></td><td><div class='docblock'><p>Wait until no more than N bytes is in output buffer</p>

<p>This is going to be used for several cases:</p>

<ol>
<li><code>Flush(0)</code> before closing the connection</li>
<li><code>Flush(0)</code> to before receiving new request (if needed)</li>
<li><code>Flush(N)</code> to wait when you can continue producing some data, this
allows TCP pushback. To be able not to put everything in output
buffer at once. Still probably more efficient than <code>Flush(0)</code></li>
</ol>
</div></td><td></td></tr><tr><td id='variant.Sleep'><code>Sleep</code></td><td><div class='docblock'><p>Wait until deadline</p>

<p>This useful for two cases:</p>

<ol>
<li>Just wait before doing anything if required by business logic</li>
<li>Wait until <code>wakeup</code> happens or atimeout whatever comes first</li>
</ol>
</div></td><td></td></tr></table><h2 id='implementations'>Trait Implementations</h2><h3 id='derived_implementations'>Derived Implementations </h3><h3 class='impl'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> for <a class='enum' href='../rotor_stream/enum.Expectation.html' title='rotor_stream::Expectation'>Expectation</a></code></h3><div class='impl-items'><h4 id='method.fmt' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#method.fmt' class='fnname'>fmt</a>(&amp;self, __arg_0: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/core/fmt/type.Result.html' title='core::fmt::Result'>Result</a></code></h4>
</div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "rotor_stream";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>